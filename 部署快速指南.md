# SendWalk å¿«é€Ÿéƒ¨ç½²æŒ‡å—

## ğŸš€ 5 åˆ†é’Ÿå¿«é€Ÿéƒ¨ç½²

### å‰ææ¡ä»¶

- âœ… æ‹¥æœ‰ä¸€å° Ubuntu 20.04+ æœåŠ¡å™¨
- âœ… æ‹¥æœ‰ root è®¿é—®æƒé™
- âœ… åŸŸåå·²é…ç½® DNS

### å¿«é€Ÿæ­¥éª¤

#### 1. **ç™»å½•æœåŠ¡å™¨**

```bash
ssh root@your_server_ip
```

#### 2. **ä¸‹è½½å¹¶è¿è¡Œç¯å¢ƒé…ç½®è„šæœ¬**

```bash
# ä¸‹è½½é…ç½®è„šæœ¬
wget https://raw.githubusercontent.com/your-repo/sendwalk/main/setup-server.sh

# æˆ–è€…æ‰‹åŠ¨åˆ›å»ºè„šæœ¬ï¼ˆè§ä¸‹æ–¹ï¼‰
nano setup-server.sh

# æ‰§è¡Œè„šæœ¬
chmod +x setup-server.sh
./setup-server.sh
```

> **æ³¨æ„**: setup-server.sh è„šæœ¬å†…å®¹è§ã€Šç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æŒ‡å—.mdã€‹æ­¥éª¤1

#### 3. **éƒ¨ç½²ä»£ç **

```bash
# å…‹éš†ä»£ç 
cd /var/www
git clone https://github.com/your-username/sendwalk.git
cd sendwalk

# è®¾ç½®æƒé™
chown -R www-data:www-data /var/www/sendwalk
```

#### 4. **é…ç½®åç«¯**

```bash
cd /var/www/sendwalk/backend

# å®‰è£…ä¾èµ–
composer install --optimize-autoloader --no-dev

# é…ç½®ç¯å¢ƒ
cp .env.example .env
nano .env  # ä¿®æ”¹æ•°æ®åº“ç­‰é…ç½®

# ç”Ÿæˆå¯†é’¥å’Œè¿ç§»æ•°æ®åº“
php artisan key:generate
php artisan migrate --force

# ä¼˜åŒ–
php artisan config:cache
php artisan route:cache
php artisan view:cache

# è®¾ç½®æƒé™
chown -R www-data:www-data storage bootstrap/cache
chmod -R 775 storage bootstrap/cache
```

#### 5. **é…ç½®å‰ç«¯**

```bash
cd /var/www/sendwalk/frontend

# å®‰è£…ä¾èµ–å’Œæ„å»º
npm install
npm run build
```

#### 6. **é…ç½® Nginx**

```bash
# å¤åˆ¶é…ç½®æ¨¡æ¿ï¼ˆå‡è®¾é¡¹ç›®ä¸­æœ‰ï¼‰
cp /var/www/sendwalk/nginx/api.conf /etc/nginx/sites-available/sendwalk-api
cp /var/www/sendwalk/nginx/frontend.conf /etc/nginx/sites-available/sendwalk-frontend

# æˆ–æ‰‹åŠ¨åˆ›å»ºé…ç½®ï¼ˆè§ã€Šç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æŒ‡å—.mdã€‹æ­¥éª¤5ï¼‰

# å¯ç”¨ç«™ç‚¹
ln -s /etc/nginx/sites-available/sendwalk-api /etc/nginx/sites-enabled/
ln -s /etc/nginx/sites-available/sendwalk-frontend /etc/nginx/sites-enabled/

# æµ‹è¯•å¹¶é‡å¯
nginx -t
systemctl restart nginx
```

#### 7. **é…ç½® Supervisor**

```bash
# å¤åˆ¶é…ç½®æ–‡ä»¶
cp /var/www/sendwalk/supervisor/scheduler.conf /etc/supervisor/conf.d/sendwalk-scheduler.conf
cp /var/www/sendwalk/supervisor/worker.conf /etc/supervisor/conf.d/sendwalk-worker-manager.conf

# æˆ–æ‰‹åŠ¨åˆ›å»ºé…ç½®ï¼ˆè§ã€Šç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æŒ‡å—.mdã€‹æ­¥éª¤6ï¼‰

# é‡æ–°åŠ è½½
supervisorctl reread
supervisorctl update
supervisorctl start all
```

#### 8. **é…ç½® SSL**

```bash
# ä½¿ç”¨ Certbot è‡ªåŠ¨é…ç½®
certbot --nginx -d api.sendwalk.com
certbot --nginx -d www.sendwalk.com -d sendwalk.com
```

#### 9. **éªŒè¯éƒ¨ç½²**

```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
systemctl status nginx php8.3-fpm mysql redis-server
supervisorctl status

# æµ‹è¯• API
curl https://api.sendwalk.com/api/health

# è®¿é—®å‰ç«¯
# åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ https://www.sendwalk.com
```

---

## ğŸ“¦ ä½¿ç”¨è‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬

å¦‚æœæ‚¨å·²ç»å®Œæˆäº†åˆæ¬¡éƒ¨ç½²ï¼Œåç»­æ›´æ–°å¯ä»¥ä½¿ç”¨è‡ªåŠ¨åŒ–è„šæœ¬ï¼š

```bash
cd /var/www/sendwalk

# ä¸€é”®éƒ¨ç½²æ›´æ–°
./deploy.sh production
```

è¿™å°†è‡ªåŠ¨å®Œæˆï¼š
- âœ… æ‹‰å–æœ€æ–°ä»£ç 
- âœ… æ›´æ–°ä¾èµ–
- âœ… è¿è¡Œæ•°æ®åº“è¿ç§»
- âœ… æ¸…é™¤å’Œé‡å»ºç¼“å­˜
- âœ… æ„å»ºå‰ç«¯
- âœ… è®¾ç½®æƒé™
- âœ… é‡å¯æœåŠ¡
- âœ… éªŒè¯éƒ¨ç½²

---

## ğŸ” å¸¸è§é—®é¢˜é€ŸæŸ¥

### Q: 502 Bad Gateway

```bash
# é‡å¯ PHP-FPM
systemctl restart php8.3-fpm

# æ£€æŸ¥é”™è¯¯æ—¥å¿—
tail -f /var/log/nginx/error.log
```

### Q: 500 Internal Server Error

```bash
# æŸ¥çœ‹ Laravel æ—¥å¿—
tail -f /var/www/sendwalk/backend/storage/logs/laravel-*.log

# æ£€æŸ¥æƒé™
chown -R www-data:www-data storage bootstrap/cache
chmod -R 775 storage bootstrap/cache

# æ¸…é™¤ç¼“å­˜
php artisan config:clear
php artisan cache:clear
```

### Q: Worker ä¸å·¥ä½œ

```bash
# æ£€æŸ¥ Supervisor çŠ¶æ€
supervisorctl status

# é‡å¯ Worker
supervisorctl restart sendwalk-worker-manager

# æŸ¥çœ‹æ—¥å¿—
tail -f /var/www/sendwalk/backend/storage/logs/manager.log
```

### Q: å‰ç«¯æ— æ³•è®¿é—® API

æ£€æŸ¥ CORS é…ç½®ï¼š

```bash
cd /var/www/sendwalk/backend
grep -E "FRONTEND_URL|SANCTUM|SESSION" .env

# åº”è¯¥åŒ…å«ï¼š
# FRONTEND_URL=https://www.sendwalk.com
# SANCTUM_STATEFUL_DOMAINS=www.sendwalk.com
# SESSION_DOMAIN=.sendwalk.com
```

---

## ğŸ“‹ éƒ¨ç½²æ£€æŸ¥æ¸…å•ï¼ˆç®€åŒ–ç‰ˆï¼‰

- [ ] æœåŠ¡å™¨ç¯å¢ƒé…ç½®å®Œæˆ
- [ ] ä»£ç å…‹éš†æˆåŠŸ
- [ ] æ•°æ®åº“åˆ›å»ºå¹¶é…ç½®
- [ ] åç«¯ä¾èµ–å®‰è£…å®Œæˆ
- [ ] æ•°æ®åº“è¿ç§»å®Œæˆ
- [ ] å‰ç«¯æ„å»ºå®Œæˆ
- [ ] Nginx é…ç½®æ­£ç¡®
- [ ] SSL è¯ä¹¦é…ç½®å®Œæˆ
- [ ] Supervisor è¿è¡Œæ­£å¸¸
- [ ] æ‰€æœ‰æœåŠ¡æ­£å¸¸è¿è¡Œ
- [ ] å¯ä»¥è®¿é—®å‰ç«¯å’Œ API

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- **å®Œæ•´éƒ¨ç½²æŒ‡å—**: æŸ¥çœ‹ã€Šç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æŒ‡å—.mdã€‹
- **åŸæœ‰éƒ¨ç½²æ–‡æ¡£**: æŸ¥çœ‹ `docs/deployment.md`
- **API æ–‡æ¡£**: æŸ¥çœ‹ `docs/api.md`
- **æ•°æ®åº“æ¶æ„**: æŸ¥çœ‹ `docs/database-schema.md`

---

## ğŸ’¡ å°è´´å£«

### é¦–æ¬¡éƒ¨ç½²æ¨èæµç¨‹

1. âœ… å…ˆåœ¨æµ‹è¯•ç¯å¢ƒå®Œæ•´æµ‹è¯•
2. âœ… å‡†å¤‡æ•°æ®åº“å¤‡ä»½æ–¹æ¡ˆ
3. âœ… é…ç½®ç›‘æ§å’Œå‘Šè­¦
4. âœ… å‡†å¤‡å›æ»šæ–¹æ¡ˆ
5. âœ… é€‰æ‹©ä½å³°æœŸéƒ¨ç½²

### ç»´æŠ¤å»ºè®®

```bash
# æ¯å‘¨æ£€æŸ¥ä¸€æ¬¡ç³»ç»ŸçŠ¶æ€
cd /var/www/sendwalk/backend
./check_cleanup_status.sh

# æ¯æœˆæŸ¥çœ‹ä¸€æ¬¡æ—¥å¿—æ–‡ä»¶å¤§å°
du -sh storage/logs/

# å®šæœŸå¤‡ä»½æ•°æ®åº“
# è§ã€Šç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æŒ‡å—.mdã€‹ç›‘æ§å’Œç»´æŠ¤éƒ¨åˆ†
```

---

## âš¡ æ€§èƒ½ä¼˜åŒ–é€ŸæŸ¥

### PHP ä¼˜åŒ–

```bash
nano /etc/php/8.3/fpm/php.ini

# å…³é”®é…ç½®ï¼š
# memory_limit = 512M
# upload_max_filesize = 100M
# post_max_size = 100M
# max_execution_time = 300
```

### MySQL ä¼˜åŒ–

```bash
nano /etc/mysql/mysql.conf.d/mysqld.cnf

# å…³é”®é…ç½®ï¼š
# max_connections = 200
# innodb_buffer_pool_size = 1G
```

### Redis ä¼˜åŒ–

```bash
nano /etc/redis/redis.conf

# å…³é”®é…ç½®ï¼š
# maxmemory 512mb
# maxmemory-policy allkeys-lru
```

---

## ğŸ†˜ éœ€è¦å¸®åŠ©ï¼Ÿ

1. æŸ¥çœ‹å®Œæ•´çš„ã€Šç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æŒ‡å—.mdã€‹
2. æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶æ’æŸ¥é—®é¢˜
3. è¿è¡Œç³»ç»Ÿæ£€æŸ¥è„šæœ¬
4. æŸ¥çœ‹ Nginx/PHP é”™è¯¯æ—¥å¿—

---

## âœ… éƒ¨ç½²å®Œæˆå

æ­å–œï¼ğŸ‰ æ‚¨å·²æˆåŠŸéƒ¨ç½² SendWalk åˆ°ç”Ÿäº§ç¯å¢ƒã€‚

**ä¸‹ä¸€æ­¥ï¼š**
- åˆ›å»ºç¬¬ä¸€ä¸ªç®¡ç†å‘˜è´¦å·
- é…ç½® SMTP æœåŠ¡å™¨
- åˆ›å»ºç¬¬ä¸€ä¸ªé‚®ä»¶æ´»åŠ¨
- é…ç½®ç›‘æ§å’Œå¤‡ä»½
- æ·»åŠ å›¢é˜Ÿæˆå‘˜

**è®°å¾—ï¼š**
- å®šæœŸæŸ¥çœ‹æ—¥å¿—
- å®šæœŸå¤‡ä»½æ•°æ®åº“
- ä¿æŒç³»ç»Ÿæ›´æ–°
- ç›‘æ§æœåŠ¡å™¨èµ„æº

ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼ ğŸš€

