# æ—¥å¿—é…ç½®å¿«é€Ÿå‚è€ƒ

## âœ… å·²å®Œæˆé…ç½®

### 1. **æ—¥å¿—é©±åŠ¨**ï¼šæŒ‰å¤©æ»šåŠ¨ï¼ˆ`daily`ï¼‰
- æ¯å¤©è‡ªåŠ¨åˆ›å»ºæ–°æ—¥å¿—æ–‡ä»¶
- ä¿ç•™æœ€è¿‘ 30 å¤©çš„æ—¥å¿—
- æ–‡ä»¶å‘½åæ ¼å¼ï¼š`laravel-YYYY-MM-DD.log`

### 2. **ä¸“ç”¨æ—¥å¿—é€šé“**
- `laravel.log` - ä¸»æ—¥å¿—ï¼ˆé»˜è®¤ï¼‰
- `worker.log` - Worker è¿›ç¨‹æ—¥å¿—
- `email.log` - é‚®ä»¶å‘é€æ—¥å¿—
- `scheduler.log` - è°ƒåº¦å™¨æ—¥å¿—

### 3. **è‡ªåŠ¨æ¸…ç†**
- æ¯å¤©å‡Œæ™¨ 3:00 è‡ªåŠ¨æ¸…ç† 30 å¤©å‰çš„æ—¥å¿—
- å‘½ä»¤ï¼š`php artisan logs:cleanup --days=30`

## ğŸ“– å¸¸ç”¨å‘½ä»¤

### æŸ¥çœ‹æ—¥å¿—
```bash
# å®æ—¶æŸ¥çœ‹ä¸»æ—¥å¿—
tail -f storage/logs/laravel-$(date +%Y-%m-%d).log

# å®æ—¶æŸ¥çœ‹ Worker æ—¥å¿—
tail -f storage/logs/worker-$(date +%Y-%m-%d).log

# å®æ—¶æŸ¥çœ‹é‚®ä»¶æ—¥å¿—
tail -f storage/logs/email-$(date +%Y-%m-%d).log

# æœç´¢é”™è¯¯æ—¥å¿—
grep -r "ERROR" storage/logs/ | grep $(date +%Y-%m-%d)
```

### æ‰‹åŠ¨æ¸…ç†
```bash
# é¢„è§ˆä¼šåˆ é™¤çš„æ–‡ä»¶ï¼ˆä¸å®é™…åˆ é™¤ï¼‰
php artisan logs:cleanup --dry-run

# æ¸…ç† 30 å¤©å‰çš„æ—¥å¿—
php artisan logs:cleanup

# æ¸…ç† 7 å¤©å‰çš„æ—¥å¿—
php artisan logs:cleanup --days=7
```

### ä½¿ç”¨ä¸“ç”¨æ—¥å¿—é€šé“
```php
// Worker æ—¥å¿—
Log::channel('worker')->info('Worker started', ['campaign_id' => 25]);

// é‚®ä»¶æ—¥å¿—
Log::channel('email')->error('Email failed', ['error' => $e->getMessage()]);

// è°ƒåº¦å™¨æ—¥å¿—
Log::channel('scheduler')->info('Scheduler running');

// é»˜è®¤æ—¥å¿—
Log::info('General log');
```

## ğŸ”§ ç¯å¢ƒå˜é‡

åœ¨ `.env` ä¸­é…ç½®ï¼š

```bash
LOG_CHANNEL=daily          # æŒ‰å¤©æ»šåŠ¨
LOG_LEVEL=debug            # æ—¥å¿—çº§åˆ«
LOG_DAILY_DAYS=30          # ä¿ç•™å¤©æ•°
```

## ğŸ“Š æµ‹è¯•

è¿è¡Œå®Œæ•´æµ‹è¯•ï¼š
```bash
./test_log_rotation.sh
```

## ğŸ“ è¯¦ç»†æ–‡æ¡£

æŸ¥çœ‹å®Œæ•´æ–‡æ¡£ï¼š
```bash
cat æ—¥å¿—æŒ‰å¤©æ»šåŠ¨è¯´æ˜.md
```

